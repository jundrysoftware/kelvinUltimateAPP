{"version":3,"sources":["./src/app/pages/checkout/checkout.page.html","./src/app/pages/checkout/checkout-routing.module.ts","./src/app/pages/checkout/checkout.module.ts","./src/app/pages/checkout/checkout.page.scss","./src/app/pages/checkout/checkout.page.ts"],"names":[],"mappings":"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","file":"pages-checkout-checkout-module-es2015.js","sourcesContent":["export default \"<ion-header class=\\\"ion-no-border\\\">\\n  <ion-toolbar color=\\\"dark\\\">\\n\\n    <!-- Back to previous page -->\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button color=\\\"white\\\" default-href=\\\"\\\" (click)=\\\"dismiss()\\\" text=\\\"\\\" icon=\\\"arrow-back\\\">\\n      </ion-back-button>\\n    </ion-buttons>\\n\\n    <!-- Title -->\\n    <ion-title></ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-card class=\\\"welcome-card\\\" style=\\\"margin-top: auto;margin-bottom: auto;\\\">\\n  <ion-img src=\\\"/assets/stripe.png\\\"></ion-img>\\n  <ion-card-header>\\n    <ion-card-subtitle>Checkout</ion-card-subtitle>\\n    <ion-card-title>Pay with Stripe</ion-card-title>\\n    <ion-row>\\n      <ion-col>Total Payment</ion-col>\\n      <ion-col>$ {{valorpago}} </ion-col>\\n    </ion-row>\\n  </ion-card-header>\\n  <ion-card-content>\\n    <form action=\\\"/\\\" method=\\\"post\\\" id=\\\"payment-form\\\">\\n      <div class=\\\"form-row\\\">\\n        <div id=\\\"card-element\\\">\\n          <!-- a Stripe Element will be inserted here. -->\\n        </div>\\n        <!-- Used to display Element errors -->\\n        <div id=\\\"card-errors\\\" role=\\\"alert\\\"></div>\\n      </div>\\n      <ion-button type=\\\"submit\\\" color=\\\"success\\\" expand=\\\"full\\\">Make Payment</ion-button>\\n    </form>\\n  </ion-card-content>\\n</ion-card>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CheckoutPage } from './checkout.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CheckoutPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CheckoutPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CheckoutPageRoutingModule } from './checkout-routing.module';\n\nimport { CheckoutPage } from './checkout.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CheckoutPageRoutingModule\n  ],\n  declarations: [CheckoutPage]\n})\nexport class CheckoutPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2NoZWNrb3V0L2NoZWNrb3V0LnBhZ2Uuc2NzcyJ9 */\";","import { Component, OnInit } from '@angular/core';\ndeclare var Stripe;\nimport { HttpClient } from \"@angular/common/http\";\nimport Swal from 'sweetalert2';\nimport { Router } from '@angular/router';\nimport { StorageService } from '../../services/storage.service';\nimport { MethodApiServiceService } from '../../services/method-api-service.service';\nimport { Product } from '../../models/product.model';\n\n@Component({\n  selector: 'app-checkout',\n  templateUrl: './checkout.page.html',\n  styleUrls: ['./checkout.page.scss'],\n})\nexport class CheckoutPage implements OnInit {\n\n  stripe = Stripe('pk_test_51HdzaMJIWmXMvhqj9x3dBdLLpuuiYlI4EJcFF15XEvajtun9Qm6wu1SdopTvCYcML57NB5An5D62CdlGRytg6Wph00PkDTlUOG');\n  card: any;\n  valorpago : string = '0';\n  cartProducts: Product[] = [];\n\n  constructor(private http: HttpClient,private router: Router,\n    public storageService: StorageService,\n    private _methodsApiRestService: MethodApiServiceService) {\n  }\n\n  ngOnInit() {\n    this.setupStripe();\n    this.valorpago = localStorage.getItem('pagos');\n    if(this.valorpago=='' || this.valorpago== null){\n      this.valorpago = '0'\n    }\n  }\n\n  setupStripe() {\n    let elements = this.stripe.elements();\n    var style = {\n      base: {\n        color: '#32325d',\n        lineHeight: '24px',\n        fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n        fontSmoothing: 'antialiased',\n        fontSize: '16px',\n        '::placeholder': {\n          color: '#aab7c4'\n        }\n      },\n      invalid: {\n        color: '#fa755a',\n        iconColor: '#fa755a'\n      }\n    };\n\n    this.card = elements.create('card', { style: style });\n    console.log(this.card);\n    this.card.mount('#card-element');\n\n    this.card.addEventListener('change', event => {\n      var displayError = document.getElementById('card-errors');\n      if (event.error) {\n        displayError.textContent = event.error.message;\n      } else {\n        displayError.textContent = '';\n      }\n    });\n\n    var form = document.getElementById('payment-form');\n    form.addEventListener('submit', event => {\n      event.preventDefault();\n      this.stripe.createSource(this.card).then(result => {\n        if (result.error) {\n          var errorElement = document.getElementById('card-errors');\n          errorElement.textContent = result.error.message;\n        } else {\n          this.makePayment(result);\n        }\n      });\n    });\n  }\n\n  makePayment(token) {\n    var name = localStorage.getItem('name');\n    var email = localStorage.getItem('email');\n    var amount = localStorage.getItem('pagos')+'00';\n    if(parseInt(amount)>0){\n      this.http\n      .post('http://localhost:4242/create-charge', {\n          token: token.source.id,\n          name: name,\n          email:email,\n          amount:amount\n        })\n        .subscribe(data => {\n          if(data['charge']['status'] = 'succeeded'){\n            let datos = {\n              price:localStorage.getItem('pagos'),\n              status: 'approed',\n              cliente : localStorage.getItem('iduser'),\n              shipping : '123',\n              tax : '12'\n            }\n            this._methodsApiRestService.PostMethod('create_orders_controller.php',datos)\n            .subscribe(\n              response => {\n                if(response['code']==200){\n                  let obj = JSON.parse(localStorage.getItem('_cap_my-cart'));\n                  localStorage.removeItem(\"_cap_my-cart\");\n                  localStorage.removeItem(\"pagos\");\n                  for(let x of obj){\n                    let prod={\n                      orden:response['orden'],\n                      product: x['id'],\n                      cant: x['quantity']\n                    }\n                    this._methodsApiRestService.PostMethod('create_product_order_controller.php',prod)\n                    .subscribe(\n                      response => {\n                       console.log(response);\n                      },\n                        error => {\n                          if (!error.ok) {\n                            Swal.fire(\"Ups!\", \"Error en Petición\", \"error\");\n                          }\n                        }\n                    );\n                  }\n                }\n              },\n                error => {\n                  if (!error.ok) {\n                    Swal.fire(\"Ups!\", \"Error en Petición\", \"error\");\n                  }\n                }\n            );\n            this.valorpago = '0';\n            this.router.navigate(['/tabs/tab1']);\n            Swal.fire('Transaction succesfull!', 'Your transaction has been aproved succesfully', 'success');\n          }else{\n            Swal.fire('Transaction Error!', 'Status: ' + data['charge']['status'], 'error');\n          }\n        });\n    }\n  }\n\n}\n"],"sourceRoot":"webpack:///"}